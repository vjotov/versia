<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="Content-Type"><title>Chapter 2. Version Control - ClearCase VOBs</title><meta name="generator" content="DocBook XSL Stylesheets V1.49"><meta name="generator" content="SGI XSL DocBook Customization Stylesheets V1.0"><link rel="home" href="index.html" title="CASEVision&#8482;/ClearCase
Concepts Guide"><link rel="up" href="index.html" title="CASEVision&#8482;/ClearCase
Concepts Guide"><link rel="previous" href="ch01.html" title="Chapter 1. Introduction to ClearCase"><link rel="next" href="ch03.html" title="Chapter 3. ClearCase Meta-Data"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 2. Version Control - ClearCase VOBs</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01.html" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch01.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch03.html" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch03.html">Next</a></td></tr></table><hr></div><!--CONTENT_BEGIN--><div class="chapter"><div class="titlepage"><div><h2 class="title"><a name="id5437063"></a>Chapter 2. <a name="id17474"></a>Version Control - ClearCase VOBs</h2></div></div>
<p>ClearCase supports a well-organized, controlled development environment by maintaining two kinds of data storage:<a name="idch2vob2"></a></p>
<div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><b>Permanent data repository</b></span> &#8212; a globally-accessible, shared data resource that can be modified only by ClearCase commands. The repository contains both historical and current development data.</p>
</li>
<li><p><span class="bold"><b>Working data storage</b></span> &#8212; any number of distinct areas which provide &#8220;scratchpad storage&#8221; for day-to-day development activities. A typical area belongs to an individual user, or to a small group working on the same task.</p>
</li>
</ul></div><p>This chapter and the next describe the contents of <i>versioned object bases</i>, which implement the permanent data repository. Working data storage, implemented by <i>views</i>, is discussed briefly in this chapter and more fully in <a href="ch04.html#id76462" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch04.html#id76462">Chapter 4, &#8220;ClearCase Views.&#8221;</a></p>
<div class="section"><div class="titlepage"><div><h2 class="title"><a name="id5437182"></a><a name="id36884"></a>Versioned Object Bases (VOBs)</h2></div></div>
<p>A <a name="idch2vob3"></a><i>versioned object base</i>, or <i>VOB</i>, is the permanent data repository for a development tree or subtree. A VOB stores file system objects: directories, files, symbolic links, and hard links. (It also stores non-file-system information, <a name="idch2vob4"></a><i>meta-data</i>, which we discuss in <a href="ch03.html#id59167" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch03.html#id59167">Chapter 3, &#8220;ClearCase Meta-Data.&#8221;</a></p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5437241"></a>Using VOBs: Clients, Servers, and Views</h3></div></div>
<p>Many version-control systems require users to perform their day-to-day work on copies of data, only occasionally accessing the permanent data repository. ClearCase allows users to work directly with the repository &#8212; that is, directly with VOBs. Direct access is implemented coherently and securely in the multiple-user, multiple-host environment by combining several mechanisms (<a name="idch2vob5"></a><a href="ch02.html#id18546" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id18546">Figure 2-1</a>):</p>
<div class="itemizedlist"><ul type="disc"><li><p><a name="idch2vob6"></a><span class="bold"><b>View context</b></span> &#8212; Any program, not just a ClearCase program, can read a VOB's data. But a program must use a ClearCase <i>view</i> to access a VOB; otherwise, the VOB appears to be empty. Through the view, the VOB appears to be a standard directory tree.</p>
</li>
<li><p><a name="idch2vob7"></a><span class="bold"><b>Client programs </b></span>&#8212; A VOB can be modified only by special ClearCase client programs. Most version-control operations are implemented by <i>cleartool</i> (command-line interface), and by (graphical user interface). Audited builds are performed with <i>clearmake</i> and <tt>clearaudit</tt>.</p>
</li>
<li><p><a name="idch2vob8"></a><span class="bold"><b>VOB activation</b></span> &#8212; Typically, a VOB is located on a remote host, rather than on the user's own host. A VOB is made available on the user's host by <a name="idch2vob9"></a><i>activating</i> it there, through operating system networking facilities. For example, on a UNIX system, a VOB is activated by mounting it as a file system of type MVFS &#8212; ClearCase's <i>multiversion file system</i> type.</p>
</li>
<li><p><a name="idch2vob10"></a><span class="bold"><b>Server programs</b></span> &#8212; Only ClearCase <i>server programs</i>, running on the host where the VOB physically resides, perform the &#8220;real&#8221; work: retrieving data from the VOB and updating it. Client programs communicate with server programs using operating system remote-procedure-call (RPC) facilities.</p>
</li>
</ul></div><p>Typically, a user works on his or her own <i>client host</i>, accessing VOBs that are physically located on one or more remote <i>VOB server hosts</i>.</p>
<p><div class="figure"><p><a name="id5437436"></a><b>Figure 2-1. <a name="id18546"></a><a name="idch2vob11"></a>How ClearCase Users Access a VOB</b></p>
<div class="mediaobject"><img src="Fig2-1.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-1.gif"></div></div><br>
</p>
</div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="id5437478"></a><a name="id30332"></a>VOB Data Structures</h2></div></div>
<p>A VOB is implemented as a <a name="idch2vob12"></a><i>VOB storage directory</i>, a directory tree whose principal contents are a set of storage pools and an embedded database (<a href="ch02.html#id12266" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id12266">Figure 2-2</a>).</p>
<p><div class="figure"><p><a name="id5437506"></a><b>Figure 2-2. <a name="id12266"></a>VOB Storage Directory</b></p>
<div class="mediaobject"><img src="Fig2-2.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-2.gif"></div></div><br>
</p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5437522"></a>VOB Storage Pools</h3></div></div>
<p>A <a name="idch2vob13"></a><i>VOB storage pool</i> is a subdirectory that stores users' file system data. Some storage pools provide a repository for historical and currently-used versions of source files. Other storage pools provide a repository for object modules, executables, and other <a name="idch2vob14"></a><i>derived objects</i> created during the development process.</p>
<p>Each VOB is created with an initial set of pools, located within the VOB storage directory. These can be supplemented (or replaced) with pools located on the same disk, on another local disk, or on a remote host. This affords administrators great flexibility, enabling data storage to be placed on hosts where ClearCase itself is not installed (for example, a very fast file server machine).</p>
<p>ClearCase can store individual versions of files in several ways, using such techniques as data compression and line-by-line <a name="idch2vob15"></a><a name="idch2vob16"></a><i>deltas</i>. The data storage/retrieval facility is extensible &#8212; users can supply their own <i>type managers</i>, implementing customized methods for storing and retrieving development data. (See <a href="ch02.html#id28975" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id28975">&#8220;Element Types and Type Managers&#8221;</a>.)</p>
</div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5437643"></a>VOB Database</h3></div></div>
<p>Each VOB has a <a name="idch2vob17"></a><i>VOB database</i>, a subdirectory containing information managed by the database management system embedded in ClearCase. The VOB database stores version-control information, along with a wealth of other information, including:</p>
<div class="itemizedlist"><ul type="disc"><li><p>user-defined annotations on source file versions</p>
</li>
<li><p>complete &#8220;bill-of-materials&#8221; records of software builds</p>
</li>
<li><p><i>event records</i> that chronicle the changes that users have made to the VOB: creation of new versions, adding of annotations, renaming of source files, and so on</p>
</li>
</ul></div><p>This information is termed <a name="idch2vob18"></a><i>meta-data</i>, to distinguish it from file system data. We describe it in more detail in <a href="ch03.html#id59167" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch03.html#id59167">Chapter 3, &#8220;ClearCase Meta-Data.&#8221;</a>.</p>
</div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="id5437714"></a>Elements, Branches, and Versions</h2></div></div>
<p>Each ClearCase VOB stores version-controlled file system objects, termed <a name="idch2vob19"></a><i>elements</i>. An element is a file or directory for which ClearCase maintains multiple <i>versions</i>. The versions of an element are logically organized into a hierarchical <i>version tree</i>, which can include multiple <i>branches</i> and <i>subbranches</i> (<a href="ch02.html#id86440" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id86440">Figure 2-3</a>).</p>
<p><div class="figure"><p><a name="id5437756"></a><b>Figure 2-3. <a name="id86440"></a>Version Trees of ClearCase Elements</b></p>
<div class="mediaobject"><img src="Fig2-3.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-3.gif"></div></div><br>
</p>
<p>Some elements may have version trees with a single branch &#8212; the versions form a simple linear sequence. But typically, users define additional branches in some of the elements, in order to isolate work on such tasks as bug fixing, code reorganization, experimentation, and platform-specific development.<a name="idch2vob20"></a></p>
<p><a href="ch02.html#id86440" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id86440">Figure 2-3</a> illustrates several features of ClearCase version trees:</p>
<div class="itemizedlist"><ul type="disc"><li><p>Each element is created with a single branch, named <a name="idch2vob21"></a><tt>main</tt>, which has an empty version, numbered 0.</p>
</li>
<li><p>ClearCase automatically assigns integer <a name="idch2vob22"></a><i>version numbers</i> to versions. Each version can also have one or more user-defined <i>version labels</i> (for example, <tt>REL1</tt>, <tt>REL2_BETA</tt>, <tt>REL2</tt>).</p>
</li>
<li><p>One or more branches can be created at any version, each with a user-defined name. (Branches are not numbered in any way.)</p>
</li>
<li><p>ClearCase supports multiple branching levels.</p>
</li>
<li><p><i>Version 0</i> on a branch is identical to the version at the branch point.</p>
</li>
</ul></div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5437931"></a>Version-IDs</h3></div></div>
<p>Each version of an element has a unique <a name="idch2vob23"></a><i>version-ID</i>, which indicates its location in the version tree. A version-ID takes the form of a <i>branch-pathname</i> followed by a <i>version-number</i> (<a href="ch02.html#id52344" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id52344">Figure 2-4</a>).</p>
<p><div class="figure"><p><a name="id5437962"></a><b>Figure 2-4. <a name="id52344"></a>Version-ID of a Version</b></p>
<div class="mediaobject"><img src="Fig2-4.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-4.gif"></div></div><br>
</p>
<p>For example, the shaded versions at the end of the branches in <a href="ch02.html#id86440" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id86440">Figure 2-3</a> have these version-IDs:


</p>
<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">
/main/5
/main/motif/2
/main/bugs/3
/main/bugs/bug404/1
/main/bugs/bug417/1
</pre></td></tr></table><p>Version-IDs look like pathnames because an element's version tree has the same hierarchical structure as a directory tree. Version-IDs work like pathnames, too, as described below.</p>
</div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5438028"></a><a name="id16658"></a>Letting the View Select Versions</h3></div></div>
<p>Typically, users wish to access only one version of an element at a time. A ClearCase <a name="idch2vob24"></a><tt>view</tt> provides a work environment in which at most one version (or perhaps no version at all) of each version-controlled object appears. Thus, a particular view might resolve a simple file name or a full pathname:</p>
<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">
util.c
   ... or ...
/vobs/vega/src/util.c
</pre></td></tr></table><p>... to version <tt>/main/5</tt> of file element <tt>util.c</tt>. Another view might resolve the same pathname to version <tt>/main/motif/2</tt>.</p>
<p>The ability to reference any version with a standard operating system pathname is a very important ClearCase feature, termed <a name="idch2vob25"></a><i>transparency</i>. This is what makes a VOB appear to be a standard directory tree, as illustrated in <a href="ch02.html#id18546" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id18546">Figure 2-1</a>. Standard operating system utilities and third-party development tools &#8220;just work&#8221; with VOB data, without requiring any modification, conversion, or wrapper routines. For more on transparency, see <a href="ch04.html#id76462" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch04.html#id76462">Chapter 4, &#8220;ClearCase Views.&#8221;</a>.</p>
</div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5438152"></a><a name="id26728"></a>Accessing Any Version with a Version-Extended Pathname</h3></div></div>
<p>Any version of an element can be uniquely specified by appending its version-ID to its standard pathname, forming a <a name="idch2vob26"></a><i>version-extended pathname</i>. <a href="ch02.html#id15123" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id15123">Figure 2-5</a> shows an example.</p>
<p><div class="figure"><p><a name="id5438241"></a><b>Figure 2-5. <a name="id15123"></a>Version-Extended Pathname</b></p>
<div class="mediaobject"><img src="Fig2-5.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-5.gif"></div></div><br>
</p>
<p>A version-extended pathname can also use a version label; this enables users to reference versions mnemonically:<a name="idch2vob27"></a></p>
<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">
% cat util.c@@/REL2
% diff messages.c messages.c@@/REL3_BSLVL2
% /usr/local/bin/validate bgrs.h@@/NEW_STRUCT_TEST
</pre></td></tr></table><p>Version-extended pathnames can be used in standard commands, either alone or in conjunction with standard pathnames. For example, this command searches for a character string in the &#8220;current&#8221; version and in two &#8220;historical&#8221; versions:</p>
<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">
% grep  &quot;InLine&quot;  monet.c  monet.c@@/main/13  monet.c@@/RLS2.5
</pre></td></tr></table><br><div class="section"><div class="titlepage"><div><h4 class="title"><a name="id5438297"></a>More Extended Pathnames</h4></div></div>
<p>The <a name="idch2vob28"></a><tt>extended naming symbol</tt> <tt>(</tt>by default<i>, @@</i>) suppresses ClearCase's automatic version-selection mechanism. It causes the MVFS to interpret the pathname as a reference to the element itself, or to some location in its version tree:</p>
<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">
util.c <i>(the version selected by the view)</i>
util.c@@ <i>(the element itself)</i>
util.c@@/main <i>(one of the element's branches)</i>
util.c@@/main/2 <i>(a specific version of the element)</i>
</pre></td></tr></table><p>The entire version tree of an element is embedded under its standard pathname. This enables users to access any (or all) historical versions through pathnames, using any program. The following variant of the above <tt>grep</tt> command shows the power of this file system extension:</p>
<table bgcolor="#E0E0E0" width="90%" border="1" cellpadding="10"><tr><td><pre class="literallayout">
% grep  &quot;InLine&quot;  monet.c@@/main/*
</pre></td></tr></table><p>In this command, a standard shell wildcard character (*) specifies all the versions on an element's <i>main</i> branch.</p>
</div></div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="id5438433"></a>How New Versions Are Created</h2></div></div>
<p>This section describes ClearCase facilities for managing the creation of new versions and branches in version-controlled elements.<a name="idch2vob29"></a></p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5438447"></a>The Checkout-Edit-Checkin Model</h3></div></div>
<p>Like many version-control systems, ClearCase uses a checkout-edit-checkin model to manage the growth of elements' version trees:<a name="idch2vob30"></a></p>
<div class="orderedlist"><ol type="1"><li><p>In the &#8220;steady-state&#8221;, an element is read-only &#8212; users can neither modify it or remove it.<a name="idch2vob31"></a></p>
</li>
<li><p>To modify an element, a user establishes a view context, then enters a <a name="idch2vob32"></a><tt>checkout</tt> command. This seems simply to change the element from read-only to read-write; in actuality, it makes an editable copy &#8212; a <i>checked-out version</i>. (For details, see <a href="ch04.html#id38269" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch04.html#id38269">&#8220;Revising a Source File / Checkout-Edit-Checkin&#8221;</a>.)</p>
</li>
<li><p>The user revises the checked-out version using any available system-supplied or third-party tools.</p>
</li>
<li><p>The user enters a <a name="idch2vob33"></a><tt>checkin</tt> command. This creates a new, permanent version of the element, which then reverts to the &#8220;steady-state&#8221; of being read-only.</p>
</li>
</ol></div><div class="section"><div class="titlepage"><div><h4 class="title"><a name="id5438540"></a>Reserved and Unreserved Checkouts</h4></div></div>
<p>When entering a <tt>checkout</tt> command, the user implicitly expresses an intention to create a new version of the element at some future time. ClearCase supports either a &#8220;first-come-first-served&#8221; approach or an &#8220;exclusive privilege&#8221; approach to managing the creation of new versions.</p>
<p>A <a name="idch2vob34"></a><i>reserved</i> checkout grants the exclusive privilege to create the next version on the branch; a branch can have only one reserved checkout at a time. But a branch can have any number of <i>unreserved</i> checkouts. If several users, in different views, have unreserved checkouts of a branch, the first one to perform a <tt>checkin</tt> &#8220;wins&#8221;; the others must combine the changes in the newly-created version into their own work before they can perform a <tt>checkin</tt>. (See <a href="ch02.html#id38883" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id38883">&#8220;Merging Versions of an Element&#8221;</a>.)</p>
</div></div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5438624"></a><a name="id36576"></a>Creating Versions in a Parallel Development Environment</h3></div></div>
<p>In a parallel development environment, the same element can be modified by several projects concurrently; each project creates versions on its own branch, isolated from the changes being made by other projects on other branches.<a name="idch2vob35"></a></p>
<p><a href="ch02.html#id73852" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id73852">Figure 2-6</a> shows an element with two subbranches: the <i>r2_fix</i> branch is for maintenance work; the <i>gopher_port</i> branch is for porting the application to a new architecture. This figure also shows how the <tt>checkout</tt> command supports parallel development, by localizing its effects:</p>
<div class="itemizedlist"><ul type="disc"><li><p>The <tt>checkout</tt> command operates on a particular branch of an element, not on the entire element. Several different branches might be checked out at the same time, each for a different programming task. (<tt>checkout</tt> always checks out the last version on a branch; revising an intermediate version requires creation of a subbranch at that version.) </p>
</li>
<li><p>An element's branch is checked out to one particular view. The checked-out version is visible only in that view; the <tt>checkout</tt> command leaves all other views unaffected. Each view can checkout only one branch at a time of any given element, because the view can see only one object at the element's pathname.</p>
<p><div class="figure"><p><a name="id5438740"></a><b>Figure 2-6. <a name="id73852"></a>Parallel Development</b></p>
<div class="mediaobject"><img src="Fig2-6.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-6.gif"></div></div><br>
</p>
</li>
</ul></div></div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5438783"></a><a name="id38883"></a>Merging Versions of an Element</h3></div></div>
<p>In a parallel development environment, different branches of an element can remain active for arbitrarily long periods. The contents of the branches inevitably diverge more and more as time passes. In some cases, this may be acceptable; but most organizations wish to keep an element's <a name="idch2vob36"></a><i>main</i> branch up-to-date &#8212; with bugfixes, with architecture-dependent constructs, and so on. This means that changes made on subbranches must periodically be <i>merged</i> back into the <i>main</i> branch. It is also typical for data to be merged onto other branches &#8212; for example, a branch used to develop a port of an application.</p>
<p>ClearCase includes flexible and powerful merge tools. Often, the process of merging all the work performed for a particular development project is completely automatic. When conflicting changes to the same section of code prevent a merge from being completely automatic, users can invoke the <a name="idch2vob37"></a><tt>xcleardiff</tt> graphical merge utility to resolve the conflicts and perform any necessary cleanup (<a href="ch02.html#id22050" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id22050">Figure 2-7</a>).</p>
<p><div class="figure"><p><a name="id5438852"></a><b>Figure 2-7. <a name="id22050"></a>Graphical Merge Utility: `xcleardiff'</b></p>
<div class="mediaobject"><img src="Fig2-7.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-7.gif"></div></div><br>
</p>
<p>ClearCase supports many variants of the basic merge scenario. For example:</p>
<div class="itemizedlist"><ul type="disc"><li><p>Any version of an element can be merged into any other version; the target need not be on the <i>main</i> branch.</p>
</li>
<li><p>A <i>selective merge</i> can incorporate some, but not all, of the changes made on one branch into another branch.</p>
</li>
<li><p>A <a name="idch2vob38"></a><i>subtractive merge</i> can remove the changes made in a set of versions.</p>
</li>
</ul></div></div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="id5438917"></a><a name="id21582"></a>The Version as Compound Object</h2></div></div>
<p>A version is actually a two-part compound object:<a name="idch2vob39"></a></p>
<div class="itemizedlist"><ul type="disc"><li><p><a name="idch2vob40"></a><span class="bold"><b>Object in the VOB database</b></span> &#8212; There is a <i>version</i> object in the VOB database. Pointers to branch and element objects establish the location of the version object in some element's version tree. The version object can have user annotations (for example, version labels); it is referenced by various ClearCase-generated event records and build configuration records.</p>
</li>
<li><p><a name="idch2vob41"></a><span class="bold"><b>File in a VOB storage pool</b></span> &#8212; There is a <i>data container</i> file in one of the VOB's source storage pools. This file contains the version's file system data.</p>
</li>
</ul></div><p><a href="ch02.html#id72098" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id72098">Figure 2-8</a> illustrates the relationship between the two components of a version. In general, ClearCase commands operate directly on the database object; standard programs operate on the associated data container.</p>
<p><div class="figure"><p><a name="id5439041"></a><b>Figure 2-8. <a name="id72098"></a>The Version as Compound Object</b></p>
<div class="mediaobject"><img src="Fig2-8.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-8.gif"></div></div><br>
</p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5439058"></a>Special Cases</h3></div></div>
<p>In general, users need not be concerned with the dual nature of a version. Some ClearCase features, however, are best understood by keeping the duality in mind. For example:</p>
<div class="itemizedlist"><ul type="disc"><li><p>Users can create versions that consist only of a VOB database object (along with its user annotations and ClearCase-generated records). Similarly, the data container of an existing version can be discarded, leaving only the database object.</p>
</li>
<li><p>Administrators can move the data containers of existing versions to different storage pools.</p>
</li>
<li><p>A view can be configured so that the file system data of some versions disappear, but the corresponding database objects remain accessible to ClearCase client programs.</p>
</li>
</ul></div></div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="id5439103"></a><a name="id28975"></a>Element Types and Type Managers</h2></div></div>
<p>Each element has an <a name="idch2vob42"></a><i>element type</i>, which can be used for either or both of these purposes:</p>
<div class="itemizedlist"><ul type="disc"><li><p>to provide a logical or functional classification for the element<a name="idch2vob43"></a></p>
</li>
<li><p>to determine how the element's versions are to be stored and retrieved</p>
</li>
</ul></div><p>ClearCase has several predefined element types, each of which represents a different physical file format for data container file(s) in a source storage pool. Each element type has its own data-access method, which optimizes either performance or storage requirements:<a name="idch2vob44"></a></p>
<div class="variablelist"><table border="0" cellspacing="3"><tr valign="top"><td><span class="term"><i>file</i>
</span></td><td width="10"> </td><td><p><i></i>arbitrary sequence of bytes; each version is stored in whole-copy format (&#8220;as-is&#8221;) in a separate data container file</p>

</td></tr><tr valign="top"><td><span class="term"><a name="idch2vob45"></a><i>text_file</i></span></td><td width="10"> </td><td><p>sequence of non-NULL bytes, separated into &#8220;text lines&#8221; by <tt>&lt;NL&gt;</tt> characters; all versions are stored efficiently as <i>deltas</i> (incremental differences) in a single structured data container file</p>

</td></tr><tr valign="top"><td><span class="term"><a name="idch2vob46"></a><i>compressed_file</i> and <i>compressed_text_file</i></span></td><td width="10"> </td><td><p><br>
variants of <i>file</i> and <i>text_file </i>that use standard UNIX data-compression techniques; compression typically reduces the disk storage requirement by 25%&#8211;50%</p>

</td></tr></table></div><p>The element types <a name="idch2vob47"></a><a name="idch2vob48"></a><i>file</i> and <i>compressed_file</i> can be used to version-control any file, including executables, programming libraries, databases, bitmap images, and non-ASCII desktop-publishing documents.</p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5439311"></a>Cleartext Storage Pools</h3></div></div>
<p>ClearCase implements a performance optimization for all file elements whose versions are not stored in whole-copy format. This includes text files (stored in delta format) and compressed files. ClearCase attempts to amortize the cost of &#8220;extracting&#8221; a particular version (by applying deltas, or by uncompressing) over multiple accesses to the version:<a name="idch2vob49"></a></p>
<div class="itemizedlist"><ul type="disc"><li><p>The first time an existing version is extracted from its data container, the &#8220;clear text&#8221; of the version is stored in a data container in a <i>cleartext storage pool</i>.</p>
</li>
<li><p>On subsequent accesses to the same version, the cleartext data container is used again, eliminating the need for another &#8220;extraction&#8221;.</p>
</li>
</ul></div><p>Thus, a cleartext storage pool acts as a cache of the file system data for recently-accessed versions.<a name="idch2vob50"></a></p>
</div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5439389"></a>User-Defined Element Types</h3></div></div>
<p>Users can define their own element types to classify elements functionally, enabling such operations as:<a name="idch2vob51"></a></p>
<div class="itemizedlist"><ul type="disc"><li><p>easily identifying and defining operations on all of a project's header files</p>
</li>
<li><p>using a particular icon to represent header files in the ClearCase GUI</p>
</li>
<li><p>using different version-selection criteria for different element types</p>
</li>
<li><p>requiring that C-language source files (but not header files) be subjected to a <tt>lint</tt>(1) check when they are modified</p>
</li>
</ul></div><p>ClearCase includes an automatic <a name="idch2vob52"></a><i>file typing</i> mechanism, which enables element types to be applied efficiently and consistently. For example, new file elements whose names end with<i> .c</i> might automatically be assigned the user-defined element type <tt>c_source</tt>.</p>
</div><div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5439465"></a>Type Managers</h3></div></div>
<p>Another reason for ClearCase sites to define their own element types is to handle different physical or logical file formats. Each element type has an associated suite of programs, its <a name="idch2vob53"></a><a name="idch2vob54"></a><i>type manager</i>, which handles the task of accessing the element's versions in a VOB storage pool. For example, the type manager <i>text_file_delta</i> implements the efficient storage of version-to-version changes as <i>deltas</i> in a single, structured <i>data container</i> file.</p>
<p>A user-defined element type can have its own, user-supplied type manager suite. For example:</p>
<div class="itemizedlist"><ul type="disc"><li><p>A type manager for elements of type <i>bitmap</i> might compute incremental differences between versions of a bitmap file, and store all the versions in a single, structured data container file.</p>
</li>
<li><p>A type manager for elements of type <i>frame_file</i> might use special routines to compare two versions of a FrameMaker® document.</p>
</li>
<li><p>A type manager for elements of type <i>manual_page </i>might compare two versions of a manual page source file by first formatting them with the standard <tt>nroff</tt> program.</p>
</li>
</ul></div></div></div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="id5439644"></a>Version Control of Links</h2></div></div>
<p>Most implementations of UNIX support two kinds of links:<a name="idch2vob55"></a></p>
<div class="itemizedlist"><ul type="disc"><li><p>A <a name="idch2vob56"></a><i>hard link</i> is a directory entry that provides an alternative name for an existing file. The file's &#8220;original&#8221; name and all its additional hard links are completely equivalent.</p>
</li>
<li><p>A <a name="idch2vob57"></a><i>symbolic link</i> is a directory entry whose contents is a character string that specifies a full or relative pathname. The link acts as a pointer to a file or directory (or another symbolic link). Many UNIX functions and commands &#8220;chase&#8221; this pointer: a reference to a symbolic link becomes a reference to the object at the full or partial pathname specified by the link.</p>
</li>
</ul></div><p>As counterparts to standard UNIX links, ClearCase supports <i>VOB hard links</i> and <i>VOB symbolic links</i>:</p>
<div class="itemizedlist"><ul type="disc"><li><p>A <i>VOB hard link</i> is a directory entry that provides an additional name for an existing element in the same VOB.</p>
</li>
<li><p>A <i>VOB symbolic link</i> is an object whose contents is a character string that specifies a pathname. The pathname can specify a location in the same VOB, in a different VOB, or a non-VOB location.</p>
</li>
</ul></div><p>An essential difference between these kinds of objects is that VOB symbolic links do not have version trees (since they do not name elements). Version-control of VOB symbolic links is accomplished through directory versioning, as described in the next section


.</p>
</div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="id5439747"></a>Version Control of Directories</h2></div></div>
<p>Some version-control systems are good at tracking the changes to the <a name="idch2vob58"></a><span class="emphasis"><i>contents</i></span> of files, but have little or no ability to handle changes to the <span class="emphasis"><i>names</i></span> of files. Name changes are a fact of life in long-lived projects. So are such changes as creating new files, deleting obsolete files, moving a file to a different directory, merging source files together, and completely reorganizing a multiple-level directory structure. ClearCase addresses these needs by providing version-control of directories.</p>
</div><div class="section"><div class="titlepage"><div><h2 class="title"><a name="id5439777"></a>Directory Elements</h2></div></div>
<p>Each version of a ClearCase <a name="idch2vob59"></a><i>directory element</i> is analogous to a standard UNIX directory:</p>
<div class="itemizedlist"><ul type="disc"><li><p>A UNIX directory is a list of names, each of which points (through an <a name="idch2vob60"></a><i>inode number</i>) to a file system object &#8212; file, directory, and so on.</p>
</li>
<li><p>A version of a ClearCase directory element is a list of names, each of which points (through a ClearCase-internal <a name="idch2vob61"></a><i>object-ID</i>, or <i>OID</i>) to a file element, a directory element, or a VOB symbolic link (<a href="ch02.html#id30669" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id30669">Figure 2-9</a>).</p>
<p><div class="figure"><p><a name="id5439886"></a><b>Figure 2-9. <a name="id30669"></a>Directory Element</b></p>
<div class="mediaobject"><img src="Fig2-9.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-9.gif"></div></div><br>
</p>
</li>
</ul></div><p>In many respects, a directory element resembles a file element:<a name="idch2vob62"></a></p>
<div class="itemizedlist"><ul type="disc"><li><p>It has a version tree.</p>
</li>
<li><p>Any directory version can be accessed with a version-extended pathname. For example, <tt>/vobs/vega/src@@/main/3</tt> references a particular version of directory element <tt>src</tt>.</p>
</li>
<li><p>A ClearCase view selects a particular version of each directory element. The selected versions of all directory elements in a VOB constitute a <a name="idch2vob63"></a><i>namespace</i>; different views can instantiate different namespaces.</p>
</li>
</ul></div><p><a name="idch2vob64"></a><a href="ch02.html#id29665" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id29665">Figure 2-10</a> shows the critical difference: each version of a file element is a regular file; each version of a directory element is a list of element and VOB symbolic link names.</p>
<div class="section"><div class="titlepage"><div><h3 class="title"><a name="id5439975"></a>Accessing Files through Directory Versions</h3></div></div>
<p>A version of a file element is accessed by first traversing a hierarchy of directory versions. Accessing a particular version of element <a name="idch2vob65"></a><a name="idch2vob66"></a><tt>/vobs/vega/src/util.c</tt> involves:</p>
<div class="itemizedlist"><ul type="disc"><li><p>accessing some version of <tt>/vobs/vega</tt> (the VOB's top-level or <i>root</i> directory)</p>
</li>
<li><p>accessing a version of directory element <tt>src</tt></p>
</li>
<li><p>accessing the desired version of <tt>util.c</tt></p>
</li>
</ul></div><p>Although directory versions are essential for managing long-lived projects, users need not think about them on a day-to-day basis. ClearCase's <i>transparency</i> feature, discussed for file elements in <a href="ch02.html#id16658" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch02.html#id16658">&#8220;Letting the View Select Versions&#8221;</a>, works for directory elements, also. Thus, a view would resolve the standard pathname <tt>/vobs/vega/src/util.c</tt> automatically by selecting a version of directory <tt>vega</tt>, a version of directory <tt>src</tt>, and a version of file <tt>util.c</tt>. (For more, see <a href="ch04.html#id91998" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch04.html#id91998">&#8220;Transparency and Its Alternatives&#8221;</a>.)</p>
<p><div class="figure"><p><a name="id5440133"></a><b>Figure 2-10. <a name="id29665"></a>File Element vs. Directory Element</b></p>
<div class="mediaobject"><img src="Fig2-10.gif" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/figures/Fig2-10.gif"></div></div><br>
</p>
</div></div></div><!--CONTENT_END--><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01.html" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch01.html">Prev</a> </td><td width="20%" align="center"><a accesskey="h" href="index.html" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/index.html">Table of Contents</a></td><td width="40%" align="right"> <a accesskey="n" href="ch03.html" tppabs="http://techpubs.sgi.com/library/dynaweb_docs/0620/SGI_Developer/books/ClrC_CG/sgi_html/ch03.html">Next</a></td></tr><tr><td width="40%" align="left">Chapter 1. Introduction to ClearCase </td><td width="20%" align="center"> </td><td width="40%" align="right">Chapter 3. ClearCase Meta-Data </td></tr></table></div></body></html>
